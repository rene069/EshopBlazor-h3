@page "/"
@using EshopBlazor.Models
@using EshopBlazor.Services
@inject IProduktServices _Produktservices
@inject NavigationManager Navigation
@inject IJSRuntime JsRuntime


<PageTitle>Index</PageTitle>






@foreach (var item in produktDTOs)
{
    <div class="card" style="width: 18rem;">
        <img src="@item.ImageURL" asp-append-version="true" class="card-img-top" alt="...">
        <div class="card-body">
            <h5 class="card-title">@item.ProduktName</h5>
            <p class="card-text">@item.Description</p>
            <p class="card-text">@item.Price Kr.</p>
            <button class="btn btn-primary" @onclick='() => Navigation.NavigateTo($"/ProduktDetail/{item.ProduktId}")'>Go to Product</button>
            <button class="btn btn-primary" @onclick='() => Navigation.NavigateTo($"/EditProdukt/{item.ProduktId}")'>Edit</button>
            <button @onclick="() => DeleteProdukt(item.ProduktId)" class="btn btn-danger">Delete Produkt</button>
            <button></button>

        </div>
    </div>
}


@code {
    public List<ProduktDTO> produktDTOs = new();


    protected override async Task OnInitializedAsync()
    {
        produktDTOs = await _Produktservices.GetProduktsAsync();

        await base.OnInitializedAsync();
    }

    public async Task DeleteProdukt(int id)
    {
        if (!await JsRuntime.InvokeAsync<bool>("confirm", $"Are you aure you wanna delete this Produkt?")) { return; }
        await _Produktservices.DeleteProdukt(id);
        produktDTOs = await _Produktservices.GetProduktsAsync();
    }
}